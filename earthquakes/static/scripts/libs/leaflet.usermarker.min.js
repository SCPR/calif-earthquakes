/**
 * Leaflet.UserMarker v1.0
 *
 * Author: Jonatan Heyman <http://heyman.info>
 */

(function(e){var t=L.divIcon({className:"leaflet-usermarker",iconSize:[34,34],iconAnchor:[17,17],popupAnchor:[0,-20],labelAnchor:[11,-3],html:""});var n=L.divIcon({className:"leaflet-usermarker",iconSize:[34,34],iconAnchor:[17,17],popupAnchor:[0,-20],labelAnchor:[11,-3],html:'<i class="pulse"></i>'});var r=L.divIcon({className:"leaflet-usermarker",iconSize:[18,18],iconAnchor:[9,9],popupAnchor:[0,-10],labelAnchor:[11,-3],html:""});var i=L.divIcon({className:"leaflet-usermarker-small",iconSize:[18,18],iconAnchor:[9,9],popupAnchor:[0,-10],labelAnchor:[11,-3],html:'<i class="pulse"></i>'});var s={stroke:true,color:"#03f",weight:3,opacity:.5,fillOpacity:.15,clickable:false};L.UserMarker=L.Marker.extend({options:{pulsing:false,smallIcon:false,accuracy:0},initialize:function(e,o){o=L.Util.setOptions(this,o);if(this.options.smallIcon){this.options.icon=o.pulsing?i:r}else{this.options.icon=o.pulsing?n:t}this._accMarker=L.circle(e,this.options.accuracy,s);L.Marker.prototype.initialize.call(this,e,this.options);this.on("move",function(){this._accMarker.setLatLng(this.getLatLng())}).on("remove",function(){this._map.removeLayer(this._accMarker)})},setPulsing:function(e){this._pulsing=e;this.setIcon(!!this._pulsing?n:t)},setAccuracy:function(e){this._accuracy=e;if(!this._accMarker){this._accMarker=L.circle(this._latlng,e,s).addTo(this._map)}else{this._accMarker.setRadius(e)}},onAdd:function(e){L.Marker.prototype.onAdd.call(this,e);this._accMarker.addTo(e)}});L.userMarker=function(e,t){return new L.UserMarker(e,t)}})(window)